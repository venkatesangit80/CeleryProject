SELECT 
    app_name,
    data_center,
    environment,
    CASE
        WHEN MAX(CASE WHEN status = 'active' THEN 1 ELSE 0 END) = 1 THEN 'active'
        ELSE 'passive'
    END AS final_status
FROM 
    your_table
GROUP BY 
    app_name,
    data_center,
    environment;